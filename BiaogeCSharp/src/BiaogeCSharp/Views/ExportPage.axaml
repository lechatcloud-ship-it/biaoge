<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:BiaogeCSharp.ViewModels"
             xmlns:controls="using:BiaogeCSharp.Controls"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:DataType="vm:ExportViewModel"
             x:Class="BiaogeCSharp.Views.ExportPage">

    <ScrollViewer Background="{DynamicResource BrushBgPrimary}">
        <StackPanel Margin="24" Spacing="16" MaxWidth="800">
            <!-- DWG/DXF导出卡片 -->
            <controls:CardWidget Title="导出为 DWG/DXF">
                <controls:CardWidget.CardContent>
                    <StackPanel Spacing="20">
                        <TextBlock Text="导出翻译后的图纸为 AutoCAD 格式"
                                  Foreground="{DynamicResource BrushTextSecondary}"
                                  FontSize="13"/>

                        <!-- 格式选择 -->
                        <Grid ColumnDefinitions="120,*" ColumnSpacing="12" RowDefinitions="Auto,Auto,Auto" RowSpacing="16">
                            <TextBlock Grid.Row="0" Grid.Column="0"
                                      Text="文件格式"
                                      Foreground="{DynamicResource BrushTextPrimary}"
                                      FontSize="14"
                                      VerticalAlignment="Center"/>
                            <ComboBox Grid.Row="0" Grid.Column="1"
                                     Classes="modern"
                                     SelectedIndex="0"
                                     Height="40">
                                <ComboBoxItem Content="DWG R2024"/>
                                <ComboBoxItem Content="DWG R2018"/>
                                <ComboBoxItem Content="DWG R2013"/>
                                <ComboBoxItem Content="DWG R2010"/>
                                <ComboBoxItem Content="DXF R2024"/>
                                <ComboBoxItem Content="DXF R2018"/>
                            </ComboBox>

                            <TextBlock Grid.Row="1" Grid.Column="0"
                                      Text="编码方式"
                                      Foreground="{DynamicResource BrushTextPrimary}"
                                      FontSize="14"
                                      VerticalAlignment="Center"/>
                            <ComboBox Grid.Row="1" Grid.Column="1"
                                     Classes="modern"
                                     SelectedIndex="0"
                                     Height="40">
                                <ComboBoxItem Content="UTF-8"/>
                                <ComboBoxItem Content="GBK (简体中文)"/>
                                <ComboBoxItem Content="Big5 (繁体中文)"/>
                            </ComboBox>

                            <TextBlock Grid.Row="2" Grid.Column="0"
                                      Text="保存位置"
                                      Foreground="{DynamicResource BrushTextPrimary}"
                                      FontSize="14"
                                      VerticalAlignment="Center"/>
                            <Grid Grid.Row="2" Grid.Column="1" ColumnDefinitions="*,Auto" ColumnSpacing="8">
                                <TextBox Grid.Column="0"
                                        Classes="modern"
                                        Text="{Binding DwgExportPath}"
                                        Watermark="选择保存位置"
                                        IsReadOnly="True"
                                        Height="40"/>
                                <Button Grid.Column="1"
                                       Classes="secondary"
                                       Content="浏览..."
                                       Command="{Binding BrowseDwgPathCommand}"
                                       Padding="20,0"
                                       Height="40"/>
                            </Grid>
                        </Grid>

                        <!-- 导出按钮 -->
                        <Button Classes="modern"
                                Content="导出 DWG/DXF"
                                Height="44"
                                HorizontalAlignment="Stretch"
                                Command="{Binding ExportDwgCommand}"/>
                    </StackPanel>
                </controls:CardWidget.CardContent>
            </controls:CardWidget>

            <!-- PDF导出卡片 -->
            <controls:CardWidget Title="导出为 PDF">
                <controls:CardWidget.CardContent>
                    <StackPanel Spacing="20">
                        <TextBlock Text="将图纸导出为矢量 PDF 文档"
                                  Foreground="{DynamicResource BrushTextSecondary}"
                                  FontSize="13"/>

                        <!-- PDF选项 -->
                        <Grid ColumnDefinitions="120,*" ColumnSpacing="12" RowDefinitions="Auto,Auto,Auto" RowSpacing="16">
                            <TextBlock Grid.Row="0" Grid.Column="0"
                                      Text="纸张大小"
                                      Foreground="{DynamicResource BrushTextPrimary}"
                                      FontSize="14"
                                      VerticalAlignment="Center"/>
                            <ComboBox Grid.Row="0" Grid.Column="1"
                                     Classes="modern"
                                     SelectedIndex="0"
                                     Height="40">
                                <ComboBoxItem Content="A0 (841×1189mm)"/>
                                <ComboBoxItem Content="A1 (594×841mm)"/>
                                <ComboBoxItem Content="A2 (420×594mm)"/>
                                <ComboBoxItem Content="A3 (297×420mm)"/>
                                <ComboBoxItem Content="A4 (210×297mm)"/>
                                <ComboBoxItem Content="自定义"/>
                            </ComboBox>

                            <TextBlock Grid.Row="1" Grid.Column="0"
                                      Text="质量"
                                      Foreground="{DynamicResource BrushTextPrimary}"
                                      FontSize="14"
                                      VerticalAlignment="Center"/>
                            <ComboBox Grid.Row="1" Grid.Column="1"
                                     Classes="modern"
                                     SelectedIndex="1"
                                     Height="40">
                                <ComboBoxItem Content="标准 (72 DPI)"/>
                                <ComboBoxItem Content="高质量 (150 DPI)"/>
                                <ComboBoxItem Content="打印质量 (300 DPI)"/>
                            </ComboBox>

                            <TextBlock Grid.Row="2" Grid.Column="0"
                                      Text="保存位置"
                                      Foreground="{DynamicResource BrushTextPrimary}"
                                      FontSize="14"
                                      VerticalAlignment="Center"/>
                            <Grid Grid.Row="2" Grid.Column="1" ColumnDefinitions="*,Auto" ColumnSpacing="8">
                                <TextBox Grid.Column="0"
                                        Classes="modern"
                                        Text="{Binding PdfExportPath}"
                                        Watermark="选择保存位置"
                                        IsReadOnly="True"
                                        Height="40"/>
                                <Button Grid.Column="1"
                                       Classes="secondary"
                                       Content="浏览..."
                                       Command="{Binding BrowsePdfPathCommand}"
                                       Padding="20,0"
                                       Height="40"/>
                            </Grid>
                        </Grid>

                        <CheckBox Content="嵌入字体"
                                 Foreground="{DynamicResource BrushTextPrimary}"
                                 IsChecked="{Binding EmbedFonts}"/>

                        <!-- 导出按钮 -->
                        <Button Classes="modern"
                                Content="导出 PDF"
                                Height="44"
                                HorizontalAlignment="Stretch"
                                Command="{Binding ExportPdfCommand}"/>
                    </StackPanel>
                </controls:CardWidget.CardContent>
            </controls:CardWidget>

            <!-- Excel导出卡片 -->
            <controls:CardWidget Title="导出为 Excel">
                <controls:CardWidget.CardContent>
                    <StackPanel Spacing="20">
                        <TextBlock Text="导出工程量清单到 Excel 表格"
                                  Foreground="{DynamicResource BrushTextSecondary}"
                                  FontSize="13"/>

                        <!-- Excel选项 -->
                        <Grid ColumnDefinitions="120,*" ColumnSpacing="12" RowDefinitions="Auto,Auto" RowSpacing="16">
                            <TextBlock Grid.Row="0" Grid.Column="0"
                                      Text="模板"
                                      Foreground="{DynamicResource BrushTextPrimary}"
                                      FontSize="14"
                                      VerticalAlignment="Center"/>
                            <ComboBox Grid.Row="0" Grid.Column="1"
                                     Classes="modern"
                                     SelectedIndex="0"
                                     Height="40">
                                <ComboBoxItem Content="标准工程量清单"/>
                                <ComboBoxItem Content="成本估算表"/>
                                <ComboBoxItem Content="材料汇总表"/>
                                <ComboBoxItem Content="自定义模板"/>
                            </ComboBox>

                            <TextBlock Grid.Row="1" Grid.Column="0"
                                      Text="保存位置"
                                      Foreground="{DynamicResource BrushTextPrimary}"
                                      FontSize="14"
                                      VerticalAlignment="Center"/>
                            <Grid Grid.Row="1" Grid.Column="1" ColumnDefinitions="*,Auto" ColumnSpacing="8">
                                <TextBox Grid.Column="0"
                                        Classes="modern"
                                        Text="{Binding ExcelExportPath}"
                                        Watermark="选择保存位置"
                                        IsReadOnly="True"
                                        Height="40"/>
                                <Button Grid.Column="1"
                                       Classes="secondary"
                                       Content="浏览..."
                                       Command="{Binding BrowseExcelPathCommand}"
                                       Padding="20,0"
                                       Height="40"/>
                            </Grid>
                        </Grid>

                        <StackPanel Spacing="12">
                            <CheckBox Content="包含构件详细信息"
                                     Foreground="{DynamicResource BrushTextPrimary}"
                                     IsChecked="{Binding IncludeComponentDetails}"/>
                            <CheckBox Content="包含置信度评分"
                                     Foreground="{DynamicResource BrushTextPrimary}"
                                     IsChecked="{Binding IncludeConfidenceScores}"/>
                            <CheckBox Content="包含材料清单"
                                     Foreground="{DynamicResource BrushTextPrimary}"
                                     IsChecked="{Binding IncludeMaterialList}"/>
                            <CheckBox Content="包含成本估算"
                                     Foreground="{DynamicResource BrushTextPrimary}"
                                     IsChecked="{Binding IncludeCostEstimate}"/>
                        </StackPanel>

                        <!-- 导出按钮 -->
                        <Button Classes="modern"
                                Content="导出 Excel"
                                Height="44"
                                HorizontalAlignment="Stretch"
                                Command="{Binding ExportExcelCommand}"/>
                    </StackPanel>
                </controls:CardWidget.CardContent>
            </controls:CardWidget>
        </StackPanel>
    </ScrollViewer>
</UserControl>
