# DWGæ™ºèƒ½ç¿»è¯‘ç®—é‡ç³»ç»Ÿ - å®Œæ•´åŠŸèƒ½ä½¿ç”¨æ•™ç¨‹

## ç›®å½•
1. [å›¾çº¸æŸ¥çœ‹](#1-å›¾çº¸æŸ¥çœ‹)
2. [æ™ºèƒ½ç¿»è¯‘](#2-æ™ºèƒ½ç¿»è¯‘)
3. [å·¥ç¨‹ç®—é‡](#3-å·¥ç¨‹ç®—é‡)
4. [å¯¼å‡ºåŠŸèƒ½](#4-å¯¼å‡ºåŠŸèƒ½)
5. [ç³»ç»Ÿè®¾ç½®](#5-ç³»ç»Ÿè®¾ç½®)
6. [é«˜çº§æŠ€å·§](#6-é«˜çº§æŠ€å·§)

---

## 1. å›¾çº¸æŸ¥çœ‹

### 1.1 æ‰“å¼€å›¾çº¸

**æ­¥éª¤**ï¼š
1. å¯åŠ¨åº”ç”¨ï¼š`python run.py`
2. ç‚¹å‡»å·¦ä¾§å¯¼èˆªæ çš„"å›¾çº¸æŸ¥çœ‹"
3. ç‚¹å‡»"æ‰“å¼€DWGæ–‡ä»¶"æŒ‰é’®
4. é€‰æ‹©DWGæˆ–DXFæ–‡ä»¶
5. å›¾çº¸è‡ªåŠ¨åŠ è½½å¹¶æ¸²æŸ“

**æ”¯æŒæ ¼å¼**ï¼š
- DWGï¼ˆR12-R2024æ‰€æœ‰ç‰ˆæœ¬ï¼‰
- DXFï¼ˆæ‰€æœ‰ç‰ˆæœ¬ï¼‰

**æ”¯æŒå®žä½“**ï¼š
- LINEï¼ˆçº¿æ®µï¼‰
- CIRCLEï¼ˆåœ†ï¼‰
- TEXT/MTEXTï¼ˆæ–‡æœ¬ï¼‰
- POLYLINEï¼ˆå¤šæ®µçº¿ï¼‰

### 1.2 è§†å›¾æ“ä½œ

| æ“ä½œ | æ–¹æ³• |
|-----|------|
| ç¼©æ”¾ | é¼ æ ‡æ»šè½® |
| å¹³ç§» | é¼ æ ‡ä¸­é”®æ‹–æ‹½ |
| æ”¾å¤§ | ç‚¹å‡»"æ”¾å¤§"æŒ‰é’® |
| ç¼©å° | ç‚¹å‡»"ç¼©å°"æŒ‰é’® |
| é€‚åº”çª—å£ | ç‚¹å‡»"é€‚åº”çª—å£"æŒ‰é’® |
| é‡ç½®è§†å›¾ | ç‚¹å‡»"é‡ç½®è§†å›¾"æŒ‰é’® |

### 1.3 å›¾çº¸ä¿¡æ¯

åŠ è½½å›¾çº¸åŽï¼Œç•Œé¢ä¼šæ˜¾ç¤ºï¼š
- æ–‡ä»¶å
- DWGç‰ˆæœ¬ï¼ˆå¦‚R2018ï¼‰
- å›¾å±‚æ•°é‡
- å®žä½“æ•°é‡

---

## 2. æ™ºèƒ½ç¿»è¯‘

### 2.1 é…ç½®APIå¯†é’¥

**æ–¹æ³•Aï¼šçŽ¯å¢ƒå˜é‡ï¼ˆæŽ¨èï¼‰**

Windows:
```cmd
set DASHSCOPE_API_KEY=sk-your-api-key-here
```

Linux/Mac:
```bash
export DASHSCOPE_API_KEY=sk-your-api-key-here
```

**æ–¹æ³•Bï¼šè®¾ç½®ç•Œé¢**

1. ç‚¹å‡»åº•éƒ¨"è®¾ç½®"
2. è¾“å…¥APIå¯†é’¥
3. ç‚¹å‡»"ä¿å­˜"

### 2.2 æ‰§è¡Œç¿»è¯‘

**æ­¥éª¤**ï¼š
1. ç¡®ä¿å·²åŠ è½½å›¾çº¸
2. ç‚¹å‡»"æ™ºèƒ½ç¿»è¯‘"æ ‡ç­¾
3. é€‰æ‹©æºè¯­è¨€ï¼ˆå¦‚ï¼šä¸­æ–‡ï¼‰
4. é€‰æ‹©ç›®æ ‡è¯­è¨€ï¼ˆå¦‚ï¼šè‹±æ–‡ï¼‰
5. ç‚¹å‡»"å¼€å§‹ç¿»è¯‘"
6. ç­‰å¾…è¿›åº¦æ¡å®Œæˆ

**æ”¯æŒè¯­è¨€**ï¼š
- ä¸­æ–‡ â†” è‹±æ–‡
- ä¸­æ–‡ â†” æ—¥æ–‡
- ä¸­æ–‡ â†” éŸ©æ–‡
- ä¸­æ–‡ â†” å¾·æ–‡
- ä¸­æ–‡ â†” æ³•æ–‡
- ä¸­æ–‡ â†” è¥¿ç­ç‰™æ–‡
- ä¸­æ–‡ â†” ä¿„æ–‡

### 2.3 æŸ¥çœ‹ç¿»è¯‘ç»“æžœ

**å®žæ—¶æŸ¥çœ‹**ï¼š
- åˆ‡æ¢å›ž"å›¾çº¸æŸ¥çœ‹"æ ‡ç­¾
- å›¾çº¸ä¸Šçš„æ–‡æœ¬ä¼šè‡ªåŠ¨æ˜¾ç¤ºè¯‘æ–‡

**ç¿»è¯‘ç»Ÿè®¡**ï¼š
```
æ€»å®žä½“æ•°: 1523        # å›¾çº¸ä¸­æ‰€æœ‰æ–‡æœ¬å®žä½“
å”¯ä¸€æ–‡æœ¬: 456         # åŽ»é‡åŽçš„æ–‡æœ¬æ•°é‡
ç¼“å­˜å‘½ä¸­: 398         # ä»Žç¼“å­˜ç›´æŽ¥èŽ·å–
APIç¿»è¯‘: 58           # è°ƒç”¨APIç¿»è¯‘
è·³è¿‡: 1067            # çº¯æ•°å­—/ç¬¦å·è¢«è·³è¿‡

Tokenæ¶ˆè€—: 8520
æˆæœ¬: Â¥0.0682
è€—æ—¶: 12.5ç§’
ç¼“å­˜å‘½ä¸­çŽ‡: 87.3%
```

### 2.4 ç¿»è¯‘è´¨é‡ç¤ºä¾‹

**å»ºç­‘ä¸“ä¸š**ï¼š
```
åŽŸæ–‡: C30æ··å‡åœŸæ¢ 300Ã—600
è¯‘æ–‡: C30 Concrete Beam 300Ã—600

åŽŸæ–‡: é’¢ç­‹: 4Î¦25, ç®ç­‹: Î¦8@200
è¯‘æ–‡: Reinforcement: 4Î¦25, Stirrups: Î¦8@200
```

**æœºæ¢°ä¸“ä¸š**ï¼š
```
åŽŸæ–‡: M20èžºçº¹å­” æ·±åº¦50
è¯‘æ–‡: M20 Threaded Hole Depth 50

åŽŸæ–‡: è¡¨é¢ç²—ç³™åº¦Ra1.6
è¯‘æ–‡: Surface Roughness Ra1.6
```

---

## 3. å·¥ç¨‹ç®—é‡

### 3.1 æž„ä»¶è¯†åˆ«

**æ­¥éª¤**ï¼š
1. åŠ è½½å›¾çº¸ï¼ˆå¿…é¡»å…ˆå®Œæˆï¼‰
2. ç‚¹å‡»"å·¥ç¨‹ç®—é‡"æ ‡ç­¾
3. ç‚¹å‡»"è¯†åˆ«æž„ä»¶"æŒ‰é’®
4. ç­‰å¾…è¯†åˆ«å®Œæˆ

**è¯†åˆ«èƒ½åŠ›**ï¼š

| æž„ä»¶ç±»åž‹ | è¯†åˆ«æ–¹å¼ | ç¤ºä¾‹æ–‡æœ¬ |
|---------|---------|---------|
| æ¢ | æ–‡æœ¬ï¼šæ¢/BEAM/L- | L-1, æ¢300Ã—600 |
| æŸ± | æ–‡æœ¬ï¼šæŸ±/COLUMN/C- | KZ-1, æŸ±400Ã—400 |
| å¢™ | æ–‡æœ¬ï¼šå¢™/WALL/W- | å¢™200, W-1 |
| æ¿ | æ–‡æœ¬ï¼šæ¿/SLAB/B- | æ¿120, æ¥¼æ¿ |
| é—¨ | æ–‡æœ¬ï¼šé—¨/DOOR/M- | M-1, é—¨900Ã—2100 |
| çª— | æ–‡æœ¬ï¼šçª—/WINDOW/C- | C-1, çª—1500Ã—1500 |
| æ¥¼æ¢¯ | æ–‡æœ¬ï¼šæ¥¼æ¢¯/STAIR/LT | LT-1, æ¥¼æ¢¯ |

**å›¾å½¢è¯†åˆ«**ï¼š
- çŸ©å½¢ï¼ˆå®½åº¦>1000mmï¼‰â†’ å¢™
- çŸ©å½¢ï¼ˆå®½åº¦<600mmï¼‰â†’ æŸ±
- é—­åˆå¤šæ®µçº¿ â†’ æ ¹æ®å°ºå¯¸åˆ¤æ–­

### 3.2 æŸ¥çœ‹è®¡ç®—ç»“æžœ

**è¡¨æ ¼å±•ç¤º**ï¼š

| ç±»åž‹ | æ•°é‡ | ä½“ç§¯(mÂ³) | é¢ç§¯(mÂ²) | è´¹ç”¨(å…ƒ) |
|-----|------|---------|---------|---------|
| æ¢ | 25 | 15.60 | - | Â¥7,020 |
| æŸ± | 48 | 28.80 | - | Â¥13,824 |
| å¢™ | 156 | - | 320.50 | Â¥38,460 |
| æ¿ | 12 | - | 850.20 | Â¥297,570 |
| **åˆè®¡** | **241** | **44.40** | **1170.70** | **Â¥356,874** |

**è¯¦ç»†æŠ¥è¡¨**ï¼š
```
===========================================================
å·¥ç¨‹é‡è®¡ç®—æŠ¥è¡¨
===========================================================

ã€æ¢ã€‘
  æ•°é‡: 25 ä¸ª
  ä½“ç§¯: 15.60 mÂ³
  é¢ç§¯: 0.00 mÂ²
  é•¿åº¦: 125.50 m
  è´¹ç”¨: Â¥7,020.00

ã€æŸ±ã€‘
  æ•°é‡: 48 ä¸ª
  ä½“ç§¯: 28.80 mÂ³
  é¢ç§¯: 0.00 mÂ²
  é•¿åº¦: 144.00 m
  è´¹ç”¨: Â¥13,824.00

...

===========================================================
åˆè®¡è´¹ç”¨: Â¥356,874.00
===========================================================
```

### 3.3 å•ä»·è¡¨

ç³»ç»Ÿå†…ç½®å•ä»·è¡¨ï¼ˆå¯æ ¹æ®å®žé™…è°ƒæ•´ï¼‰ï¼š

| æž„ä»¶ | è®¡ä»·æ–¹å¼ | å•ä»· |
|-----|---------|------|
| æ¢ | ä½“ç§¯ | Â¥450/mÂ³ |
| æŸ± | ä½“ç§¯ | Â¥480/mÂ³ |
| å¢™ | é¢ç§¯ | Â¥120/mÂ² |
| æ¿ | é¢ç§¯ | Â¥350/mÂ² |
| é—¨ | æ•°é‡ | Â¥800/ä¸ª |
| çª— | æ•°é‡ | Â¥600/ä¸ª |

**ä¿®æ”¹å•ä»·**ï¼š
ç¼–è¾‘ `src/calculation/quantity_calculator.py`ï¼š
```python
UNIT_PRICES = {
    ComponentType.BEAM: {'volume': 500.0},  # ä¿®æ”¹ä¸º500å…ƒ/mÂ³
    ...
}
```

---

## 4. å¯¼å‡ºåŠŸèƒ½

### 4.1 å¯¼å‡ºDWG/DXF

**æ­¥éª¤**ï¼š
1. ç‚¹å‡»"å¯¼å‡º"æ ‡ç­¾
2. ç‚¹å‡»"å¯¼å‡ºDWG/DXF"
3. é€‰æ‹©ä¿å­˜ä½ç½®
4. è¾“å…¥æ–‡ä»¶å
5. é€‰æ‹©æ ¼å¼ï¼ˆ.dwgæˆ–.dxfï¼‰
6. ç‚¹å‡»"ä¿å­˜"

**ç‰¹æ€§**ï¼š
- âœ… åŒ…å«ç¿»è¯‘åŽçš„æ–‡æœ¬
- âœ… ä¿ç•™åŽŸå›¾å½¢å…ƒç´ 
- âœ… æ”¯æŒR2010æ ¼å¼

### 4.2 å¯¼å‡ºPDF

**æ­¥éª¤**ï¼š
1. ç‚¹å‡»"å¯¼å‡ºPDF"
2. é€‰æ‹©ä¿å­˜ä½ç½®
3. ç‚¹å‡»"ä¿å­˜"

**å†…å®¹**ï¼š
- å›¾çº¸åŸºæœ¬ä¿¡æ¯
- å®žä½“ç»Ÿè®¡
- æ–‡ä»¶å…ƒæ•°æ®

### 4.3 å¯¼å‡ºExcelæŠ¥è¡¨

**å‰æ**ï¼šå¿…é¡»å…ˆæ‰§è¡Œ"å·¥ç¨‹ç®—é‡"

**æ­¥éª¤**ï¼š
1. å®Œæˆæž„ä»¶è¯†åˆ«
2. ç‚¹å‡»"å¯¼å‡º"æ ‡ç­¾
3. ç‚¹å‡»"å¯¼å‡ºExcelæŠ¥è¡¨"
4. é€‰æ‹©ä¿å­˜ä½ç½®
5. ç‚¹å‡»"ä¿å­˜"

**æŠ¥è¡¨å†…å®¹**ï¼š

| Aåˆ— | Båˆ— | Cåˆ— | Dåˆ— | Eåˆ— |
|-----|-----|-----|-----|-----|
| æž„ä»¶ç±»åž‹ | æ•°é‡ | ä½“ç§¯(mÂ³) | é¢ç§¯(mÂ²) | è´¹ç”¨(å…ƒ) |
| æ¢ | 25 | 15.60 | 0.00 | 7020.00 |
| æŸ± | 48 | 28.80 | 0.00 | 13824.00 |
| ... | ... | ... | ... | ... |
| **åˆè®¡** | - | - | - | **356874.00** |

---

## 5. ç³»ç»Ÿè®¾ç½®

### 5.1 APIå¯†é’¥ç®¡ç†

**è®¾ç½®å¯†é’¥**ï¼š
1. ç‚¹å‡»åº•éƒ¨"è®¾ç½®"
2. åœ¨"APIå¯†é’¥"è¾“å…¥æ¡†è¾“å…¥å¯†é’¥
3. å¯†é’¥ä¼šä»¥å¯†ç å½¢å¼æ˜¾ç¤ºï¼ˆ****ï¼‰
4. ç‚¹å‡»"ä¿å­˜"

**èŽ·å–å¯†é’¥**ï¼š
è®¿é—® [é˜¿é‡Œäº‘ç™¾ç‚¼æŽ§åˆ¶å°](https://dashscope.console.aliyun.com/)

### 5.2 æ¨¡åž‹é€‰æ‹©

**å¯é€‰æ¨¡åž‹**ï¼š

| æ¨¡åž‹ | æ€§èƒ½ | è´¨é‡ | æˆæœ¬ | æŽ¨èåœºæ™¯ |
|-----|------|------|------|---------|
| qwen-turbo | æœ€å¿« | â˜…â˜…â˜…â˜†â˜† | æœ€ä½Ž | ç®€å•ç¿»è¯‘ |
| qwen-plus | å¿« | â˜…â˜…â˜…â˜…â˜† | ä¸­ç­‰ | **æŽ¨è** |
| qwen-max | ä¸­ç­‰ | â˜…â˜…â˜…â˜…â˜… | æœ€é«˜ | ä¸“ä¸šæœ¯è¯­ |

**æ›´æ”¹æ–¹å¼**ï¼š
1. è®¾ç½®ç•Œé¢é€‰æ‹©æ¨¡åž‹
2. æˆ–ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š`~/.biaoge/config.toml`
```toml
[api]
model = "qwen-max"
```

### 5.3 ç¼“å­˜ç®¡ç†

**æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡**ï¼š
```python
from src.translation.cache import TranslationCache

cache = TranslationCache()
stats = cache.get_statistics()
print(stats)
```

**æ¸…ç†è¿‡æœŸç¼“å­˜**ï¼š
```python
deleted = cache.clear_expired()
print(f"æ¸…ç†äº† {deleted} æ¡")
```

**æ‰‹åŠ¨åˆ é™¤ç¼“å­˜**ï¼š
åˆ é™¤æ–‡ä»¶ï¼š`~/.biaoge/cache/translation.db`

---

## 6. é«˜çº§æŠ€å·§

### 6.1 æ‰¹é‡å¤„ç†å›¾çº¸

åˆ›å»ºPythonè„šæœ¬ï¼š
```python
import os
from src.dwg.parser import DWGParser
from src.translation.engine import TranslationEngine
from src.export.excel_exporter import ExcelExporter

# æ‰¹é‡ç¿»è¯‘
engine = TranslationEngine()
dwg_files = ['file1.dwg', 'file2.dwg', 'file3.dwg']

for file in dwg_files:
    doc = DWGParser().parse(file)
    stats = engine.translate_document(doc, 'Chinese', 'English')
    print(f"{file}: Â¥{stats.total_cost:.4f}")
```

### 6.2 è‡ªå®šä¹‰å•ä»·è¡¨

ç¼–è¾‘ `src/calculation/quantity_calculator.py`ï¼š
```python
UNIT_PRICES = {
    ComponentType.BEAM: {'volume': 450.0},
    ComponentType.COLUMN: {'volume': 480.0},
    ComponentType.WALL: {'area': 120.0},
    ComponentType.SLAB: {'area': 350.0},
    ComponentType.DOOR: {'count': 800.0},
    ComponentType.WINDOW: {'count': 600.0},
}
```

### 6.3 AIé«˜çº§è¯†åˆ«

ä½¿ç”¨AIæ™ºèƒ½è¯†åˆ«ï¼ˆéœ€è¦æ›´å¤štokensï¼‰ï¼š
```python
from src.calculation.component_recognizer import ComponentRecognizer

recognizer = ComponentRecognizer()
components = recognizer.recognize_with_ai(
    document, 
    context="ä½å®…å»ºç­‘ï¼Œåœ°ä¸Š6å±‚"  # æä¾›ä¸Šä¸‹æ–‡
)
```

### 6.4 æ€§èƒ½ä¼˜åŒ–

**å¤§å›¾çº¸ä¼˜åŒ–**ï¼š
```python
# å¯ç”¨å¹¶è¡Œè§£æž
from src.dwg.parser import OptimizedDWGParser

parser = OptimizedDWGParser()
doc = parser.parse_parallel('large_file.dwg')
```

**NumbaåŠ é€Ÿæ£€æŸ¥**ï¼š
```python
from src.calculation.quantity_calculator import QuantityCalculator

calc = QuantityCalculator()
print(f"Numbaå·²å¯ç”¨: {calc.numba_enabled}")
```

### 6.5 æ—¥å¿—è°ƒè¯•

æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼š`logs/biaoge.log`

è®¾ç½®æ—¥å¿—çº§åˆ«ï¼š
```python
import logging
from src.utils.logger import logger

logger.setLevel(logging.DEBUG)
```

---

## 7. å¸¸è§é—®é¢˜

### Q1ï¼šç¿»è¯‘å¾ˆæ…¢æ€Žä¹ˆåŠžï¼Ÿ
**A**ï¼šé¦–æ¬¡ç¿»è¯‘éœ€è¦è°ƒç”¨APIï¼ŒåŽç»­ä¼šä½¿ç”¨ç¼“å­˜ã€‚ç›¸åŒå›¾çº¸ç¬¬äºŒæ¬¡ç¿»è¯‘å‡ ä¹Žçž¬é—´å®Œæˆã€‚

### Q2ï¼šæˆæœ¬å¦‚ä½•æŽ§åˆ¶ï¼Ÿ
**A**ï¼š
1. ä½¿ç”¨ç¼“å­˜ï¼ˆ90%+å‘½ä¸­çŽ‡ï¼‰
2. é€‰æ‹©qwen-plusæ¨¡åž‹ï¼ˆæ€§ä»·æ¯”æœ€é«˜ï¼‰
3. æ‰¹é‡ç¿»è¯‘ç›¸ä¼¼å›¾çº¸

### Q3ï¼šè¯†åˆ«ä¸å‡†ç¡®æ€Žä¹ˆåŠžï¼Ÿ
**A**ï¼š
1. ç¡®ä¿æ–‡æœ¬æ ‡æ³¨æ¸…æ™°ï¼ˆæ¢L-1è€Œéžæ¨¡ç³Šæ–‡å­—ï¼‰
2. ä½¿ç”¨AIé«˜çº§è¯†åˆ«ï¼ˆéœ€æ›´å¤šæˆæœ¬ï¼‰
3. æ‰‹åŠ¨è°ƒæ•´è¯†åˆ«ç»“æžœ

### Q4ï¼šå¯¼å‡ºExcelä¹±ç ï¼Ÿ
**A**ï¼šç”¨Excel 2016+æ‰“å¼€ï¼Œæˆ–ç”¨WPS Officeã€‚

### Q5ï¼šAPIå¯†é’¥æ— æ•ˆï¼Ÿ
**A**ï¼š
1. æ£€æŸ¥å¯†é’¥æ ¼å¼ï¼š`sk-xxxxxxxxxxxxxx`
2. ç¡®è®¤å¯†é’¥å·²æ¿€æ´»
3. æ£€æŸ¥ä½™é¢æ˜¯å¦å……è¶³

---

## 8. å¿«æ·é”®ï¼ˆè®¡åˆ’ä¸­ï¼‰

| å¿«æ·é”® | åŠŸèƒ½ |
|-------|------|
| Ctrl+O | æ‰“å¼€æ–‡ä»¶ |
| Ctrl+T | ç¿»è¯‘ |
| Ctrl+E | å¯¼å‡º |
| Ctrl+Q | é€€å‡º |
| F5 | åˆ·æ–° |

---

## 9. æŠ€æœ¯æ”¯æŒ

- ðŸ“– æž¶æž„æ–‡æ¡£ï¼š`docs/01-æž¶æž„è®¾è®¡æ–‡æ¡£-PyQt6.md`
- ðŸ“– ç¿»è¯‘æŒ‡å—ï¼š`docs/ç¿»è¯‘åŠŸèƒ½ä½¿ç”¨æŒ‡å—.md`
- ðŸŒ é˜¿é‡Œäº‘æ–‡æ¡£ï¼šhttps://help.aliyun.com/zh/model-studio/
- ðŸ’¬ é—®é¢˜åé¦ˆï¼šæäº¤GitHub Issue

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ðŸŽ‰
