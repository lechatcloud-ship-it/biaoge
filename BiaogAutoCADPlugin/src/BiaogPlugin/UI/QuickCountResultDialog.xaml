<Window x:Class="BiaogPlugin.UI.QuickCountResultDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="快速统计结果 - 标哥插件" Height="600" Width="800"
        WindowStartupLocation="CenterScreen"
        Topmost="True"
        ResizeMode="CanResize"
        Background="#1E1E1E">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 标题区域 -->
        <StackPanel Grid.Row="0" Margin="0,0,0,15">
            <TextBlock Text="构件统计结果" FontSize="20" FontWeight="Bold"
                       Foreground="White"/>
            <TextBlock x:Name="SummaryText" Text="正在统计..." FontSize="12"
                       Foreground="#CCCCCC" Margin="0,5,0,0"/>
        </StackPanel>

        <!-- 过滤器区域 -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
            <TextBlock Text="最小置信度:" Foreground="#CCCCCC" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <Slider x:Name="ConfidenceSlider" Width="150" Minimum="0" Maximum="100" Value="70"
                    VerticalAlignment="Center" TickFrequency="10" IsSnapToTickEnabled="True"
                    ValueChanged="ConfidenceSlider_ValueChanged"/>
            <TextBlock x:Name="ConfidenceValueText" Text="70%" Foreground="White"
                       VerticalAlignment="Center" Margin="10,0,20,0" MinWidth="40"/>

            <Button Content="导出Excel" Width="120" Height="30" Margin="10,0,0,0"
                    Click="ExportExcelButton_Click"
                    Background="#0078D4" Foreground="White" BorderThickness="0"/>
        </StackPanel>

        <!-- 结果表格 -->
        <DataGrid Grid.Row="2" x:Name="ResultsDataGrid"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  IsReadOnly="True"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  SelectionMode="Single"
                  Background="#252526"
                  Foreground="White"
                  RowBackground="#1E1E1E"
                  AlternatingRowBackground="#2D2D30"
                  BorderBrush="#3F3F46"
                  BorderThickness="1">

            <DataGrid.ColumnHeaderStyle>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Background" Value="#2D2D30"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                    <Setter Property="Padding" Value="10,8"/>
                    <Setter Property="BorderBrush" Value="#3F3F46"/>
                    <Setter Property="BorderThickness" Value="0,0,1,1"/>
                </Style>
            </DataGrid.ColumnHeaderStyle>

            <DataGrid.CellStyle>
                <Style TargetType="DataGridCell">
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="Padding" Value="10,5"/>
                    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                </Style>
            </DataGrid.CellStyle>

            <DataGrid.Columns>
                <DataGridTextColumn Header="序号" Width="60" Binding="{Binding Index}">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center"/>
                            <Setter Property="Foreground" Value="#888"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="构件类型" Width="200" Binding="{Binding Type}">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="Foreground" Value="#4EC9B0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="数量" Width="100" Binding="{Binding Quantity}">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="平均置信度" Width="120" Binding="{Binding Confidence}">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center"/>
                            <Setter Property="Foreground" Value="#CCCCCC"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="识别次数" Width="100" Binding="{Binding Count}">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center"/>
                            <Setter Property="Foreground" Value="#888"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="备注" Width="*" Binding="{Binding Notes}">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="#888"/>
                            <Setter Property="TextWrapping" Value="NoWrap"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- 底部按钮区域 -->
        <StackPanel Grid.Row="3" Orientation="Horizontal"
                    HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button Content="复制到剪贴板" Width="120" Height="35" Margin="0,0,10,0"
                    Click="CopyToClipboardButton_Click"
                    Background="#333333" Foreground="White" BorderThickness="1" BorderBrush="#555555"/>
            <Button Content="关闭" Width="100" Height="35"
                    Click="CloseButton_Click"
                    Background="#0078D4" Foreground="White" BorderThickness="0"/>
        </StackPanel>
    </Grid>
</Window>
