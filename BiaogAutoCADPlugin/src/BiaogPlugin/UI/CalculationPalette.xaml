<UserControl x:Class="BiaogPlugin.UI.CalculationPalette"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Width="380" Background="White">
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="10">
            <!-- 标题 -->
            <TextBlock Text="构件识别算量"
                       FontSize="14" FontWeight="Bold"
                       Foreground="#333333" Margin="0,0,0,5"/>
            <Separator Margin="0,0,0,10"/>

            <!-- 识别选项 -->
            <GroupBox Header="识别选项" Margin="0,0,0,10" Padding="8">
                <StackPanel>
                    <TextBlock Text="精度模式:" Margin="0,0,0,3"/>
                    <ComboBox x:Name="PrecisionModeComboBox" Margin="0,0,0,8" SelectedIndex="1">
                        <ComboBoxItem Content="快速估算 (90%)" Tag="QuickEstimate"/>
                        <ComboBoxItem Content="预算控制 (95%, 推荐)" Tag="Budget"/>
                        <ComboBoxItem Content="竣工结算 (99%)" Tag="FinalAccount"/>
                    </ComboBox>

                    <TextBlock Text="置信度阈值:" Margin="0,5,0,3"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Slider x:Name="ConfidenceThresholdSlider" Grid.Column="0"
                                Minimum="0.5" Maximum="1.0" Value="0.8"
                                TickFrequency="0.1" IsSnapToTickEnabled="True"
                                VerticalAlignment="Center"/>
                        <TextBlock x:Name="ConfidenceThresholdText" Grid.Column="1"
                                   Text="80%" Width="35" TextAlignment="Right"
                                   VerticalAlignment="Center" Margin="5,0,0,0"/>
                    </Grid>
                </StackPanel>
            </GroupBox>

            <!-- 操作按钮 -->
            <Button x:Name="RecognizeButton" Content="开始识别构件" Height="28"
                    Margin="0,0,0,5" Click="RecognizeButton_Click"/>
            <Button x:Name="ExportExcelButton" Content="导出Excel清单" Height="24"
                    Margin="0,0,0,10" Click="ExportExcelButton_Click" IsEnabled="False"/>

            <!-- 进度 -->
            <GroupBox x:Name="ProgressCard" Header="进度" Padding="8" Margin="0,0,0,10" Visibility="Collapsed">
                <StackPanel>
                    <ProgressBar x:Name="ProgressBar" Height="18" Margin="0,0,0,5"/>
                    <TextBlock x:Name="ProgressText" Text="准备中..." FontSize="9" TextWrapping="Wrap"/>
                </StackPanel>
            </GroupBox>

            <!-- 统计信息 -->
            <GroupBox x:Name="StatsCard" Header="统计信息" Padding="8" Margin="0,0,0,10" Visibility="Collapsed">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="构件总数:" Grid.Row="0" Grid.Column="0" Margin="0,2"/>
                    <TextBlock x:Name="TotalComponentsText" Text="0" Grid.Row="0" Grid.Column="1"
                               HorizontalAlignment="Right" FontWeight="Bold" Margin="0,2"/>

                    <TextBlock Text="平均置信度:" Grid.Row="1" Grid.Column="0" Margin="0,2"/>
                    <TextBlock x:Name="AvgConfidenceText" Text="0%" Grid.Row="1" Grid.Column="1"
                               HorizontalAlignment="Right" FontWeight="Bold" Margin="0,2"/>

                    <TextBlock Text="总体积:" Grid.Row="2" Grid.Column="0" Margin="0,2"/>
                    <TextBlock x:Name="TotalVolumeText" Text="0.00m³" Grid.Row="2" Grid.Column="1"
                               HorizontalAlignment="Right" FontWeight="Bold" Margin="0,2"/>

                    <TextBlock Text="总面积:" Grid.Row="3" Grid.Column="0" Margin="0,2"/>
                    <TextBlock x:Name="TotalAreaText" Text="0.00m²" Grid.Row="3" Grid.Column="1"
                               HorizontalAlignment="Right" FontWeight="Bold" Margin="0,2"/>
                </Grid>
            </GroupBox>

            <!-- 构件列表 -->
            <GroupBox x:Name="ResultCard" Header="构件清单" Padding="8" Visibility="Collapsed">
                <ScrollViewer MaxHeight="200" VerticalScrollBarVisibility="Auto">
                    <ListBox x:Name="ComponentListBox"/>
                </ScrollViewer>
            </GroupBox>
        </StackPanel>
    </ScrollViewer>
</UserControl>
